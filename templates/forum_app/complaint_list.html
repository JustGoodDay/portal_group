{% load custom_tags %}
{% extends "base.html" %}
{% block content %}
<h1>–°–ø–∏—Å–æ–∫ –∂–∞–ª–æ–±</h1>
<a href="{% url 'complaint_create' %}">–ü–æ–¥–∞—Ç—å –Ω–æ–≤—É—é –∂–∞–ª–æ–±—É</a>
<hr>
{% for complaint in complaints %}
<div style="border:1px solid #f00; padding:10px; margin-bottom:10px;">
    <strong>–û—Ç: {{ complaint.user.username }}</strong>
    <p>{{ complaint.text }}</p>

    {% if complaint.image %}
        <img src="{{ complaint.image.url }}" alt="–§–æ—Ç–æ" style="max-width:200px;">
    {% endif %}

    <br>
    –õ–∞–π–∫–∏: {{ likes_count|get_item:complaint.id|default:"0" }}
    –î–∏–∑–ª–∞–π–∫–∏: {{ dislikes_count|get_item:complaint.id|default:"0" }}<br>

    {% if user.is_authenticated %}
        {% if user_likes|get_item:complaint.id == True %}
            <strong>–í–∏ –ª–∞–π–∫–Ω—É–ª–∏ —Ü—é —Å–∫–∞—Ä–≥—É üëç</strong>
        {% elif user_likes|get_item:complaint.id == False %}
            <strong>–í–∏ –¥–∏–∑–ª–∞–π–∫–Ω—É–ª–∏ —Ü—é —Å–∫–∞—Ä–≥—É üëé</strong>
        {% else %}
            <a href="{% url 'vote_complaint' complaint.id 1 %}">üëç</a>
            <a href="{% url 'vote_complaint' complaint.id 0 %}">üëé</a>
        {% endif %}
    {% endif %}

    <p>–°—Ç–µ–ø–µ–Ω—å —Å–µ—Ä—å—ë–∑–Ω–æ—Å—Ç–∏: {{ complaint.seriousness }}</p>
    <small>{{ complaint.created_at }}</small>
</div>
{% empty %}
<p>–ñ–∞–ª–æ–± –ø–æ–∫–∞ –Ω–µ—Ç.</p>
{% endfor %}
{% endblock %}
